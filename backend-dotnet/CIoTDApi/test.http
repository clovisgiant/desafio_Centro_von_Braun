<!-- Arquivo para testar a API via VS Code REST Client -->
@baseUrl = http://localhost:5141
@agentUrl = http://localhost:8000

# Observações:
# - Se estiver rodando via Docker e seu backend expõe 5001, troque `@baseUrl` para http://localhost:5001
# - Em Development com HTTPS, a `launchSettings.json` também expõe https://localhost:7106

### 1. Verificar saúde do Backend
GET {{baseUrl}}/health
Accept: application/json

###

### 2. Verificar saúde do Device Agent
GET {{agentUrl}}/api/health
Accept: application/json

###

### 3. Login como Admin
# @name login
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}

###
### Token obtido automaticamente: {{login.response.body.accessToken}}

###

### 4. Validar Token
POST {{baseUrl}}/api/auth/validate
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

###

### 5. Listar Dispositivos
GET {{baseUrl}}/api/device
Authorization: Bearer {{login.response.body.accessToken}}

###

### 6. Obter Detalhes - Sensor de Solo
GET {{baseUrl}}/api/device/sensor-soil-001
Authorization: Bearer {{login.response.body.accessToken}}

###

### 7. Obter Detalhes - Estação Meteorológica
GET {{baseUrl}}/api/device/sensor-weather-001
Authorization: Bearer {{login.response.body.accessToken}}

###

### 8. Obter Detalhes - Sistema de Irrigação
GET {{baseUrl}}/api/device/irrigation-system-001
Authorization: Bearer {{login.response.body.accessToken}}

###

### 9. Executar Comando - Ler Umidade
POST {{baseUrl}}/api/device/sensor-soil-001/execute
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

{
  "operation": "READ_HUMIDITY",
  "parameters": {
    "sensor_type": "humidity"
  }
}

###

### 10. Executar Comando - Definir Limiar
POST {{baseUrl}}/api/device/sensor-soil-001/execute
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

{
  "operation": "SET_THRESHOLD",
  "parameters": {
    "threshold": 65,
    "unit": "percent"
  }
}

###

### 11. Executar Comando - Ler Temperatura
POST {{baseUrl}}/api/device/sensor-weather-001/execute
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

{
  "operation": "READ_TEMPERATURE",
  "parameters": {}
}

###

### 12. Criar novo Dispositivo
POST {{baseUrl}}/api/device
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

{
  "identifier": "sensor-test-001",
  "description": "Sensor de teste",
  "manufacturer": "TestCorp",
  "url": "telnet://192.168.1.200:23",
  "commands": []
}

###

### 13. Atualizar Dispositivo
PUT {{baseUrl}}/api/device/sensor-test-001
Authorization: Bearer {{login.response.body.accessToken}}
Content-Type: application/json

{
  "identifier": "sensor-test-001",
  "description": "Sensor de teste atualizado",
  "manufacturer": "TestCorp Updated",
  "url": "telnet://192.168.1.200:23",
  "commands": []
}

###

### 14. Deletar Dispositivo
DELETE {{baseUrl}}/api/device/sensor-test-001
Authorization: Bearer {{login.response.body.accessToken}}

###
